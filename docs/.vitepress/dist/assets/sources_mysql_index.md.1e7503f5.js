import{_ as s,c as n,o as a,a as l}from"./app.47236b7f.js";const u=JSON.parse('{"title":"DBConvert-stream - Usage","description":"Counter","frontmatter":{"title":"DBConvert-stream - Usage","description":"Counter","layout":"doc","lastUpdated":true},"headers":[{"level":2,"title":"mysqldump","slug":"mysqldump","link":"#mysqldump","children":[]},{"level":2,"title":"MYSQLDUMP --SINGLE-TRANSACTION (INNODB)","slug":"mysqldump-single-transaction-innodb","link":"#mysqldump-single-transaction-innodb","children":[]},{"level":2,"title":"MYSQLDUMP --LOCK-ALL-TABLES (MYISAM)","slug":"mysqldump-lock-all-tables-myisam","link":"#mysqldump-lock-all-tables-myisam","children":[{"level":3,"title":"System variables","slug":"system-variables","link":"#system-variables","children":[]},{"level":3,"title":"GTID","slug":"gtid","link":"#gtid","children":[]},{"level":3,"title":"Docker","slug":"docker","link":"#docker","children":[]},{"level":3,"title":"Notes","slug":"notes","link":"#notes","children":[]},{"level":3,"title":"FAQ","slug":"faq","link":"#faq","children":[]}]},{"level":2,"title":"Create Stream","slug":"create-stream","link":"#create-stream","children":[]}],"relativePath":"sources/mysql/index.md","lastUpdated":1663172001000}'),o={name:"sources/mysql/index.md"},p=l(`<h1 id="mysql-related-info" tabindex="-1">MySQL Related info <a class="header-anchor" href="#mysql-related-info" aria-hidden="true">#</a></h1><h2 id="mysqldump" tabindex="-1">mysqldump <a class="header-anchor" href="#mysqldump" aria-hidden="true">#</a></h2><p>For the mysqldump user you have to grant the following minimal MySQL privileges:</p><h2 id="mysqldump-single-transaction-innodb" tabindex="-1">MYSQLDUMP --SINGLE-TRANSACTION (INNODB) <a class="header-anchor" href="#mysqldump-single-transaction-innodb" aria-hidden="true">#</a></h2><p>The following grants to mysql user should be provided:</p><ul><li>SELECT</li><li>SHOW VIEW</li><li>RELOAD</li><li>REPLICATION CLIENT</li><li>REPLICATION SLAVE</li><li>EVENT</li><li>TRIGGER</li></ul><div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> USER </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dbconvert</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">localhost</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> IDENTIFIED </span><span style="color:#F78C6C;">BY</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">secret</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">GRANT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;">, SHOW VIEW, RELOAD, REPLICATION CLIENT, REPLICATION SLAVE, </span><span style="color:#F78C6C;">EVENT</span><span style="color:#A6ACCD;">, TRIGGER </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">.</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TO</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dbconvert</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><h2 id="mysqldump-lock-all-tables-myisam" tabindex="-1">MYSQLDUMP --LOCK-ALL-TABLES (MYISAM) <a class="header-anchor" href="#mysqldump-lock-all-tables-myisam" aria-hidden="true">#</a></h2><div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">GRANT</span><span style="color:#A6ACCD;"> LOCK TABLES </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">.</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TO</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">backup</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">localhost</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">mysqldump --host=127.0.0.1 --port=3306 --user=root --password=dmsoft --master-data --single-transaction --skip-lock-tables --compact --skip-opt --quick --no-create-info --skip-extended-insert --skip-tz-utc --hex-blob --default-character-set=utf8 --column-statistics=0 --all-databases  </span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">mysqldump --host=127.0.0.1 --port=3306 --user=mysql_user --password=dmsoft --master-data --single-transaction --skip-lock-tables --compact --skip-opt --quick --no-create-info --skip-extended-insert --skip-tz-utc --hex-blob --default-character-set=utf8 --column-statistics=0 --all-databases --ssl-ca=</span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/client-ssl/ca.pem --ssl-cert=</span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/client-ssl/client-cert.pem --ssl-key=</span><span style="color:#89DDFF;">~</span><span style="color:#A6ACCD;">/client-ssl/client-key.pem</span></span>
<span class="line"></span></code></pre></div><h4 id="tls-encryption-parameters" tabindex="-1">TLS-Encryption parameters <a class="header-anchor" href="#tls-encryption-parameters" aria-hidden="true">#</a></h4><table><thead><tr><th>sslMode</th><th>Description</th></tr></thead><tbody><tr><td>disabled</td><td>Establish an unencrypted connection</td></tr><tr><td>skip-verify</td><td>Crypto/TLS accepts any certificate presented by the server and any host name in that certificate.</td></tr><tr><td>preferred</td><td>Establish an encrypted connection if the server supports encrypted connections, falling back to an unencrypted connection if an encrypted connection cannot be established.</td></tr><tr><td>verify-ca</td><td>Verify the server Certificate Authority (CA) certificate against the configured CA certificates.</td></tr></tbody></table><div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> USER </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mysql_user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> REQUIRE </span><span style="color:#F78C6C;">SSL</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> USER </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mysql_user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> REQUIRE X509;</span></span>
<span class="line"><span style="color:#F78C6C;">ALTER</span><span style="color:#A6ACCD;"> USER </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mysql_user</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> REQUIRE </span><span style="color:#F78C6C;">NONE</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><table><thead><tr><th>Path to certificate</th><th></th></tr></thead><tbody><tr><td>sslCA</td><td>File that contains list of trusted SSL Certificate Authorities</td></tr><tr><td>sslCert</td><td>File that contains X.509 certificate</td></tr><tr><td>sslKey</td><td>File that contains X.509 key</td></tr></tbody></table><h3 id="system-variables" tabindex="-1">System variables <a class="header-anchor" href="#system-variables" aria-hidden="true">#</a></h3><p><strong>binlog_row_event_max_size</strong> When row-based binary logging is used, this setting is a soft limit on the maximum size of a row-based binary log event, in bytes. More info at <a href="https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_binlog_row_event_max_size" target="_blank" rel="noreferrer">https://dev.mysql.com/doc/refman/8.0/en/replication-options-binary-log.html#sysvar_binlog_row_event_max_size</a></p><p>It affect directly on the number of Records in each event when reading from Binlog</p><p>binlog_row_event_max_size=16384</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">[2022/02/07 21:35:33] [info] source/binlog.go:27 Header: &amp;{Timestamp:1644266132 EventType:WriteRowsEventV2 ServerID:4 EventSize:16142 LogPos:2698323 Flags:0} # of Recs: 59 </span></span>
<span class="line"><span style="color:#A6ACCD;">[2022/02/07 21:35:33] [info] source/binlog.go:27 Header: &amp;{Timestamp:1644266132 EventType:WriteRowsEventV2 ServerID:4 EventSize:11228 LogPos:2709551 Flags:0} # of Recs: 41 </span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>binlog_row_event_max_size=8192</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">[2022/02/07 21:56:20] [info] source/binlog.go:27 Header: &amp;{Timestamp:1644267380 EventType:WriteRowsEventV2 ServerID:4 EventSize:7952 LogPos:2724604 Flags:0} # of Recs: 29 </span></span>
<span class="line"><span style="color:#A6ACCD;">[2022/02/07 21:56:20] [info] source/binlog.go:27 Header: &amp;{Timestamp:1644267380 EventType:WriteRowsEventV2 ServerID:4 EventSize:7952 LogPos:2732556 Flags:0} # of Recs: 29 </span></span>
<span class="line"><span style="color:#A6ACCD;">[2022/02/07 21:56:20] [info] source/binlog.go:27 Header: &amp;{Timestamp:1644267380 EventType:WriteRowsEventV2 ServerID:4 EventSize:7952 LogPos:2740508 Flags:0} # of Recs: 29 </span></span>
<span class="line"><span style="color:#A6ACCD;">[2022/02/07 21:56:20] [info] source/binlog.go:27 Header: &amp;{Timestamp:1644267380 EventType:WriteRowsEventV2 ServerID:4 EventSize:3584 LogPos:2744092 Flags:0} # of Recs: 13</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><h3 id="gtid" tabindex="-1">GTID <a class="header-anchor" href="#gtid" aria-hidden="true">#</a></h3><p><strong>enforce-gtid-consistency</strong> and <strong>gtid-mode</strong> only takes effect if binary logging takes place for a statement. No need to switch it ON for row based log. enforce-gtid-consistency=OFF gtid-mode=OFF</p><h3 id="docker" tabindex="-1">Docker <a class="header-anchor" href="#docker" aria-hidden="true">#</a></h3><h4 id="start-mysql" tabindex="-1">Start MySQL <a class="header-anchor" href="#start-mysql" aria-hidden="true">#</a></h4><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">docker run \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--detach \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--rm \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--name=mysql \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--env=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">MYSQL_ROOT_PASSWORD=dmsoft</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--publish 3306:3306 \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--volume=/home/dm/dbconvert/dbconvert-stream/config/mysql/conf.d:/etc/mysql/conf.d \\</span></span>
<span class="line"><span style="color:#A6ACCD;">--volume=/home/dm/dbconvert/dbconvert-stream/_storage/mysql-data:/var/lib/mysql \\</span></span>
<span class="line"><span style="color:#A6ACCD;">mysql</span></span>
<span class="line"></span></code></pre></div><h4 id="prepare-test-dbs" tabindex="-1">Prepare test DBs <a class="header-anchor" href="#prepare-test-dbs" aria-hidden="true">#</a></h4><p>mariadb10.2 (binlog format must be &#39;raw&#39;) In binlog.go change with your connection data</p><div class="language-json"><button class="copy"></button><span class="lang">json</span><pre><code><span class="line"><span style="color:#A6ACCD;">cfg.Addr = fmt.Sprintf(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">%s:%d</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">127.0.0.1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">3306</span><span style="color:#A6ACCD;">) </span><span style="color:#676E95;">//host,port</span></span>
<span class="line"><span style="color:#A6ACCD;">cfg.User = </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">cfg.Password = </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">root</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"></span></code></pre></div><p>Create database with sql</p><div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Test.User</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  id </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;"> auto_increment </span><span style="color:#F78C6C;">primary</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">key</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">40</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">status</span><span style="color:#A6ACCD;"> enum(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">active</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">deleted</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">active</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  created </span><span style="color:#F78C6C;">timestamp</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CURRENT_TIMESTAMP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CURRENT_TIMESTAMP</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  engine</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">InnoDB;</span></span>
<span class="line"></span></code></pre></div><div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">table</span><span style="color:#A6ACCD;"> Test.Products</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  id </span><span style="color:#F78C6C;">int</span><span style="color:#A6ACCD;"> auto_increment </span><span style="color:#F78C6C;">primary</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">key</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">name</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">varchar</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">40</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  price </span><span style="color:#F78C6C;">decimal</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">6</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  created </span><span style="color:#F78C6C;">timestamp</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">default</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CURRENT_TIMESTAMP</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">not</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">update</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CURRENT_TIMESTAMP</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">  engine</span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">InnoDB;</span></span>
<span class="line"></span></code></pre></div><p>than execute sql</p><div class="language-sql"><button class="copy"></button><span class="lang">sql</span><pre><code><span class="line"><span style="color:#F78C6C;">INSERT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">Into</span><span style="color:#A6ACCD;"> Test.User (</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">\`</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">\`</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">VALUE</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Ioann</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Test.User </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Jonh</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> id</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">DELETE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Test.User </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> id</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">Into</span><span style="color:#A6ACCD;"> Test.Products (</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">id</span><span style="color:#89DDFF;">\`</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">name</span><span style="color:#89DDFF;">\`</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">\`</span><span style="color:#C3E88D;">price</span><span style="color:#89DDFF;">\`</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">,</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Bread</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">.</span><span style="color:#F78C6C;">69</span><span style="color:#A6ACCD;">), (</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Butter</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">.</span><span style="color:#F78C6C;">59</span><span style="color:#A6ACCD;">), (</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Fanta</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">.</span><span style="color:#F78C6C;">09</span><span style="color:#A6ACCD;">) ;</span></span>
<span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Test.Products </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Coca-Cola</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> id</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">DELETE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Test.Products;</span><span style="color:#F78C6C;">sql</span></span>
<span class="line"></span></code></pre></div><h3 id="notes" tabindex="-1">Notes <a class="header-anchor" href="#notes" aria-hidden="true">#</a></h3><p>&quot;<a href="http://github.com/jmoiron/sqlx" target="_blank" rel="noreferrer">github.com/jmoiron/sqlx</a>&quot; slows down the process of transferring data to MySQL destination as it uses reflect.</p><h3 id="faq" tabindex="-1">FAQ <a class="header-anchor" href="#faq" aria-hidden="true">#</a></h3><p>Q: ERROR 1067 (42000): Invalid default value for &#39;created_at&#39;. How to solve? A: Table has a timestamp column with a default value of &quot;0000-00-00 00:00:00&quot;. The problem is due to sql_modes. Check your current sql_mode with the command:</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">show variables like &#39;sql_mode&#39; ; </span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p>And remove sql_mode &quot;NO_ZERO_IN_DATE, NO_ZERO_DATE&quot; to make it work. This is the default sql_mode in new versions of mysql.</p><p>You can set sql_mode globally as root with the command:</p><div class="language-"><button class="copy"></button><span class="lang"></span><pre><code><span class="line"><span style="color:#A6ACCD;">set global sql_mode = &#39;ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION&#39;;</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div><p><a href="https://stackoverflow.com/questions/36882149/error-1067-42000-invalid-default-value-for-created-at" target="_blank" rel="noreferrer">https://stackoverflow.com/questions/36882149/error-1067-42000-invalid-default-value-for-created-at</a></p><h2 id="create-stream" tabindex="-1">Create Stream <a class="header-anchor" href="#create-stream" aria-hidden="true">#</a></h2><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">curl --request POST --url http://127.0.0.1:8020/ -H </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Content-Type: application/json</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> -d </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">{</span></span>
<span class="line"><span style="color:#C3E88D;">   &quot;source&quot;:{</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;type&quot;:&quot;mysql&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;connection&quot;:{</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;host&quot;:&quot;0.0.0.0&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;port&quot;:3306,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;user&quot;:&quot;mysql_user&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;password&quot;:&quot;dmsoft&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;database&quot;:&quot;Source&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;sslMode&quot;:&quot;verify-ca&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;sslCA&quot;:&quot;config/mysql/client-ssl/ca.pem&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;sslCert&quot;:&quot;config/mysql/client-ssl/client-cert.pem&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;sslKey&quot;:&quot;config/mysql/client-ssl/client-key.pem&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">      },</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;settings&quot;:{</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;useDecimal&quot;:true,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;parseTime&quot;:true,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;pingInterval&quot;:10</span></span>
<span class="line"><span style="color:#C3E88D;">      },</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;initialLoad&quot;:false,</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;filter&quot;:{</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;tables&quot;:{</span></span>
<span class="line"><span style="color:#C3E88D;">            &quot;products1&quot;:[</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;snapshot&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;insert&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;update&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;delete&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">            ],</span></span>
<span class="line"><span style="color:#C3E88D;">            &quot;products2&quot;:[</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;snapshot&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;insert&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;update&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;delete&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">            ]</span></span>
<span class="line"><span style="color:#C3E88D;">         }</span></span>
<span class="line"><span style="color:#C3E88D;">      }</span></span>
<span class="line"><span style="color:#C3E88D;">   },</span></span>
<span class="line"><span style="color:#C3E88D;">   &quot;destination&quot;:{</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;type&quot;:&quot;mysql&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;connection&quot;:{</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;host&quot;:&quot;0.0.0.0&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;port&quot;:3306,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;user&quot;:&quot;mysql_user&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;password&quot;:&quot;dmsoft&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;database&quot;:&quot;Destination&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;sslMode&quot;:&quot;verify-ca&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;sslCA&quot;:&quot;config/mysql/client-ssl/ca.pem&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;sslCert&quot;:&quot;config/mysql/client-ssl/client-cert.pem&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;sslKey&quot;:&quot;config/mysql/client-ssl/client-key.pem&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">      },</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;initialLoad&quot;:false,</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;filter&quot;:{</span></span>
<span class="line"><span style="color:#C3E88D;">         &quot;tables&quot;:{</span></span>
<span class="line"><span style="color:#C3E88D;">            &quot;products1&quot;:[</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;snapshot&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;insert&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;update&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;delete&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">            ],</span></span>
<span class="line"><span style="color:#C3E88D;">            &quot;products2&quot;:[</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;snapshot&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;insert&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;update&quot;,</span></span>
<span class="line"><span style="color:#C3E88D;">               &quot;delete&quot;</span></span>
<span class="line"><span style="color:#C3E88D;">            ]</span></span>
<span class="line"><span style="color:#C3E88D;">         }</span></span>
<span class="line"><span style="color:#C3E88D;">      }</span></span>
<span class="line"><span style="color:#C3E88D;">   },</span></span>
<span class="line"><span style="color:#C3E88D;">   &quot;limits&quot;:{</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;records&quot;:100000,</span></span>
<span class="line"><span style="color:#C3E88D;">      &quot;time&quot;:0</span></span>
<span class="line"><span style="color:#C3E88D;">   }</span></span>
<span class="line"><span style="color:#C3E88D;">}</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><div class="language-bash"><button class="copy"></button><span class="lang">bash</span><pre><code><span class="line"><span style="color:#A6ACCD;">mysql -u mysql_user -p -h 127.0.0.1 --ssl-ca=config/mysql/client-ssl/ca.pem --ssl-cert=config/mysql/client-ssl/client-cert.pem --ssl-key=config/mysql/client-ssl/client-key.pem</span></span>
<span class="line"></span></code></pre></div>`,47),e=[p];function t(c,r,C,y,i,D){return a(),n("div",null,e)}const d=s(o,[["render",t]]);export{u as __pageData,d as default};
